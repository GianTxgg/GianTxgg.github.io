<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>策略路由</title>
      <link href="/2019/08/20/ce-lue-lu-you/"/>
      <url>/2019/08/20/ce-lue-lu-you/</url>
      
        <content type="html"><![CDATA[<p><strong>策略路由</strong></p><p>策略路由提供了一种根据网络管理者制定的策略来进行数据包转发的机制。基于策略的路由比传统路由能力更强，使用更灵活，它使用网络管理者不仅能够根据目的地址，而且能够根据协议类型、报文大小、应用或IP源地址来选择转发路径。策略由路由映射表来定义。</p><h2 id="实验一、基于源IP地址的策略路由配置"><a href="#实验一、基于源IP地址的策略路由配置" class="headerlink" title="实验一、基于源IP地址的策略路由配置"></a><strong>实验一、基于源IP地址的策略路由配置</strong></h2><p><strong>实验目的：</strong></p><p>1、用route-map定义路由策略。</p><p>2、在接口下应用路由策略。</p><p>3、基于源IP地址的策略路由的配置和调试。</p><p><strong>实验拓朴：</strong></p><p><img src="https://s2.ax1x.com/2019/08/21/mNbcmF.jpg" alt></p><p><strong>实验步骤：</strong></p><p>在路由器R1的f0/0接口应用IP策略路由CCNA，使得从主机PC2来的数据设置一跳地址为：172.16.12.2；从主机PC3来的数据设置下一跳地址为：172.16.21.2，所有其他的数据包正常转发，整个网络运行EIGRP路由协议。</p><p><strong>配置ACL</strong></p><p>R1(config)#access-list 1 permit 172.16.1.2</p><p>R1(config)#access-list 2 permit 172.16.1.3</p><p><strong>配置路由映射表</strong></p><p>R1(config)#route-map CCNA permit 10</p><p>R1(config-route-map)#match ip address 1</p><p>R1(config-route-map)#set ip next-hop 172.16.12.2</p><p>R1(config-route-map)#exit</p><p>R1(config)#route-map CCNA permit 20</p><p>R1(config-route-map)#match ip address 2</p><p>R1(config-route-map)#set ip next-hop 172.16.21.2</p><p><strong>应用策略路由</strong></p><p>R1(config)#int f0/0</p><p>R1(config-if)#ip policy route-map CCNA</p><p><strong>实验调试：</strong></p><p>1、<strong>查看路由路径</strong></p><p>PC2#traceroute 172.16.2.2</p><p>PC3#traceroute 172.16.2.2</p><p>2、<strong>在R1上显示调试信息</strong></p><p>R1#debug ip policy</p><p>PC2：ping 172.16.2.2  </p><p>PC6:ping 172.16.2.2</p><p><strong>3、显示在哪些接口上应用了策略路由</strong></p><p>R1#sh ip policy</p><p><strong>4、显示定义的所有路由策略及路由策略匹配的情况</strong></p><h2 id="实验二、基于数据包长度的策略路由配置"><a href="#实验二、基于数据包长度的策略路由配置" class="headerlink" title="实验二、基于数据包长度的策略路由配置"></a><strong>实验二、基于数据包长度的策略路由配置</strong></h2><p><strong>实验目的：</strong></p><p>1、用route-map定义路由策略。</p><p>2、在接口下应用路由策略。</p><p>3、基于数据包长度的策略路由的配置和调试。</p><p><strong>实验拓朴：</strong></p><p><img src="https://s2.ax1x.com/2019/08/21/mNbqTH.jpg" alt> </p><p><strong>实验步骤：</strong></p><p>在R1的f0/0接口应用IP策略路由CCNP，使得对大小为“64-100”字节的数据包设置出接口为s1/0;数据包大小“101-100”字节的数据包设置出接口为“f0/1”,所有其他的数据包正常转发，整个网络运行EIGRP路由协议。</p><p><strong>配置路由映射表</strong></p><p>R1(config)#route-map CCNP permit 10</p><p>R1(config-route-map)#match length 64 100</p><p>R1(config-route-map)#set interface s1/0</p><p>R1(config)#route-map CCNP permit 20</p><p>R1(config-route-map)#match length 101 1000</p><p>R1(config-route-map)#set interface f0/1</p><p><strong>应用策略路由</strong></p><p>R1(config)#int f0/0</p><p>R1(config-if)#ip policy route-map CCNP</p><p>R1(config-if)#exit</p><p>R1(config)#ip local policy route-map CCNP</p><p><strong>实验调试：</strong></p><p><strong>1.在主机上执行扩展ping命令，在R1上显示调试信息。</strong></p><p>PC2：ping 172.16.2.2 repeat 1 size 90</p><p>PC2：ping 172.16.2.2 repeat 1 size 300</p><p>PC2：ping 172.16.2.2 repeat 1 size 1200</p><p><strong>2、**</strong>显示在哪些接口上应用了策略路由**</p><p>R1#sh ip policy</p><p><strong>3、显示定义的所有路由策略及路由策略匹配的情况</strong></p><p>R1#sh route-map CCNP</p><h2 id="实验三、基于应用的策略路由配置"><a href="#实验三、基于应用的策略路由配置" class="headerlink" title="实验三、基于应用的策略路由配置"></a><strong>实验三、基于应用的策略路由配置</strong></h2><p><strong>实验目的：</strong></p><p>1、用route-map定义路由策略。</p><p>2、在接口下应用路由策略。</p><p>3、基于数据包长度的策略路由的配置和调试。</p><p><strong>实验拓朴：</strong></p><p><img src="https://s2.ax1x.com/2019/08/21/mNqpX8.jpg" alt></p><p><strong>实验步骤：</strong></p><p>在R1的f0/0接口应用IP策略路由CCIE，使得对HTTP数据包设置一跳地址为：172.16.12.2，并且设置IP数据包优先级为”flash”,为telnet数据包设置下一跳地址为：172.16.21.2，并且设置IP数据包优先级为：critical，所有其他的数据包正常转发，整个路由协议运行EIGRP。</p><p><strong>配置R2的http与telnet访问</strong></p><p>  R2(config)#ip http server</p><p>R2(config)#line vty 0 4</p><p>R2(config-line)#no login</p><p>R2(config-line)#privilege level 15</p><p><strong>配置扩展ACL</strong></p><p>R1(config)#ip access-list extended HTTP</p><p>R1(config-ext-nacl)#permit tcp any any eq 80</p><p>R1(config-ext-nacl)#exit</p><p>R1(config)#ip access-list extended TELNET</p><p>R1(config-ext-nacl)#permit tcp any any eq 23</p><p><strong>配置路由映射表</strong></p><p>R1(config)#route-map CCIE permit 10</p><p>R1(config-route-map)#match ip address HTTP</p><p>R1(config-route-map)#set ip precedence flash</p><p>R1(config-route-map)#set ip next-hop 172.16.12.2</p><p>R1(config)#route-map CCIE permit 20</p><p>R1(config-route-map)#match ip address TELNET</p><p>R1(config-route-map)#set ip precedence critical</p><p>R1(config-route-map)#set ip next-hop 172.16.21.2</p><p><strong>应用路由映射表</strong></p><p>R1(config)#int f0/0</p><p>R1(config-if)#ip policy route-map CCIE</p><p>R1(config)#ip local policy route-map CCIE</p>]]></content>
      
      
      
        <tags>
            
            <tag> 路由协议 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>IP地址分类</title>
      <link href="/2019/08/20/ip-di-zhi-fen-lei/"/>
      <url>/2019/08/20/ip-di-zhi-fen-lei/</url>
      
        <content type="html"><![CDATA[<h1 id="IP地址介绍及VLSM"><a href="#IP地址介绍及VLSM" class="headerlink" title="IP地址介绍及VLSM"></a>IP地址介绍及VLSM</h1><h2 id="IP地址分类"><a href="#IP地址分类" class="headerlink" title="IP地址分类"></a>IP地址分类</h2><h3 id="A类网络地址范围"><a href="#A类网络地址范围" class="headerlink" title="A类网络地址范围"></a><strong>A类网络地址范围</strong></h3><p>第一个字节的第一位必须为0，第一个字节的取值为0-127</p><p>即: 0xxxxxxx        取值范围是:  0000000-01111111 (0-127)</p><p>1.1.1.1/8        网络号: 8位        255.0.0.0</p><p>网络地址：1.0.0.0</p><p>广播地址：1.255.255.255</p><p>在这网络中有多少个地址呢？2^24</p><p>有效地址：2^24-2</p><h3 id="B类网络地址范围"><a href="#B类网络地址范围" class="headerlink" title="B类网络地址范围"></a><strong>B类网络地址范围</strong></h3><p>第一个字节的第一位必须是1，且第二位必须是0，第一个字节的取值为128-191</p><p>即：10000000   取值范围是：10000000－10111111 (128-191)</p><p>181.1.1.1/16   255.255.0.0</p><p>网络地址：181.1.0.0</p><p>广播地址：181.1.255.255</p><p>有效地址：2^16-2</p><h3 id="C类网络的地址范围"><a href="#C类网络的地址范围" class="headerlink" title="C类网络的地址范围"></a><strong>C类网络的地址范围</strong></h3><p>第一个字节的前两位必须是1，且第三位必须是0，第一个字节的取值为192-223</p><p>即:  11000000    取值范围是:  11000000-11011111  (192-223)</p><p>192.168.1.1/24  255.255.255.0</p><p>网络地址：192.168.1.0</p><p>广播地址：192.168.1.255</p><p>有效地址：2^8-2  254</p><p>D类网络的地址范围：第一个字节为224–239，用作组播地址。</p><p>E类网络的地址范围：第一个字节为240–255，用于科学用途。</p><h2 id="各类网络地址中网络数和主机数"><a href="#各类网络地址中网络数和主机数" class="headerlink" title="各类网络地址中网络数和主机数"></a><strong>各类网络地址中网络数和主机数</strong></h2><p>A 类网络地址：</p><p>　　　　　　实际可用的A类网络地址数为：2^7=128</p><p>​                         合法的主机数为：2 ^24－2＝16777214</p><p>B类网络地址：</p><p>　　　　　　实际可用的B类网络地址数为：2^14=16384</p><p>​                        合法的主机数为：2^16-2=65534</p><p>C类网络地址：</p><p>　　　　　　实际可用的C类网络地址数为：2^21=2097152</p><p>​                        合法的主机数为：2^8-2=254</p><p><strong>私有IP地址范围 在公网中是不能路由的，必须经过地址转换</strong></p><p> A类　10.0.0.0~10.255.255.255</p><p> B类    172.16.0.0~172.31.255.255</p><p> C类    192.168.0.0~192.168.255.255</p><h2 id="变长子网掩码"><a href="#变长子网掩码" class="headerlink" title="变长子网掩码"></a><strong>变长子网掩码</strong></h2><p>使用长度不同的子网掩码将网络划分成多个子网，适用于不同类型的网络设计，称为VLSM组网。</p><p>分类路由选择：RIP1  IGRP协议</p><p>无类路由选择：RIP2　EIGRP　OSPF等协议</p><p><strong>有类路由</strong>：汇总以后地址是标准的A B C类地址掩码即255.0.0.0 255.255.0.0 255.255.255.0 (有类路由里大类网络中子网码必须一致这样叫做有类路由因为有类路由协议不传递子网码信息)</p><p><strong>无类路由</strong>：汇总以后地址是无类的比如 172.16.12.0/16 - 172.16.15.0/16 汇总以后的地址是 172.16.12.0/20 子码 不属于A B C 3个类别(无类路由是相反的，他传递子网信息所有大类网络中可以使用不同的子网码)</p><p><strong>地址汇总</strong>：<br>汇总：也叫路由聚合，让路由选择协议能够用一个地址通告众多网络。旨在缩小路由器中路由选择表的规模，以节省内存，并缩短IP对路由选择表进行分析以找出前往远程网络的所需时间。</p><p>汇总实际上比较简单，因为你只需确定块大小，而这些块大小我们在学习子网划分和VLSM设计时都使用过。例如，如果要将如F网络汇总到一个网络通告中,只需确定块大小，你就能轻松地找出答案:<br>网络192.168. 16.0~ 192.168.31.0<br>块大小是多少呢?这总共恰好有16个C类网络，使用块大小16刚好能满足需求。<br>知道块大小后，你便可确定网络地址和子网掩码，它们可用于将这些网络汇总到-个通告中。用于通告汇总地址的网络地址总是块中的第-一个网络地址,这里为192.168.16.0。 在这个例子中，为确定子网掩码，什么样的子网掩码提供的块大小为16呢?答案是240, 应将第三个字节(进行汇总的字节)设置为240,因此子网掩码为255.255.240.0。<br>再来看一个示例，但这次从主机的角度看。<br>如果汇总地址为192.168.144.0/20, 我们将根据它转发前往哪些主机地址的分组?在这里，汇总地址为192.168.144.0,子网掩码为255.255.240.0。<br>第三个字节的块大小为16, 而被汇总的第一个地址为192.168.144.0, 在第三个字节加上块大小16后为160，因此汇总的地址范围为144~ 159。</p>]]></content>
      
      
      
        <tags>
            
            <tag> IP地址 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RIP 路由协议</title>
      <link href="/2019/08/09/my-first-blog/"/>
      <url>/2019/08/09/my-first-blog/</url>
      
        <content type="html"><![CDATA[<p>动态路由协议包括距离向量路由协议和链路状态路由协议。RIP（Routing InformationProtocols,路由信息协议）是使用最广泛的距离向量路由协议。RIP 是为小型网络环境设计的，因为这类协议的路由学习及路由更新将产生较大的流量,占用过多的带宽。</p><a id="more"></a><h2 id="RIP-概述"><a href="#RIP-概述" class="headerlink" title="RIP 概述"></a><strong>RIP 概述</strong></h2><p>RIP 是由Xerox 在70 年代开发的，最初定义在RFC1058 中。RIP 用两种数据包传输更新:更新和请求,每个有RIP 功能的路由器默认情况下每隔30 秒利用UDP 520 端口向与它直连的网络邻居广播(RIP v1)或组播(RIP v2)路由更新。因此路由器不知道网络的全局情况,如果路由更新在网络上传播慢，将会导致网络收敛较慢，造成路由环路。为了避免路由环路， RIP 采用水平分割、毒性逆转、定义最大跳数、闪式更新、抑制计时5 个机制来避免路由环路。 </p><p>RIP 协议分为版本1 和版本2。不论是版本1 或版本2，都具备下面的特征： </p><ol><li>是距离向量路由协议； </li><li>使用跳数（Hop Count）作为度量值； </li><li>默认路由更新周期为30 秒；</li><li>管理距离（AD）为120； </li><li>支持触发更新； </li><li>最大跳数为15 跳； </li><li>支持等价路径,默认4 条,最大6 条； </li><li>使用UDP520 端口进行路由更新。</li></ol><p>而RIPv1 和RIPv2 的区别如表 </p><table><thead><tr><th>RIPv1</th><th>RIPv2</th></tr></thead><tbody><tr><td>在路由更新的过程中不携带子网信息</td><td>在路由更新的过程中携带子网信息</td></tr><tr><td>不提供认证</td><td>提供明文和MD5认证</td></tr><tr><td>不支持VLSM和CIDR</td><td>支持VLSM和CIDR</td></tr><tr><td>采用广播更新</td><td>采用组播（224.0.0.9）更新</td></tr><tr><td>有类别（Classful）路由协议</td><td>无类别（Classless）路由协议</td></tr></tbody></table><p><img src="https://s2.ax1x.com/2019/08/19/m34VjP.png" alt></p><p>首先保证直连的连通性</p><p>在R1上:</p><pre><code>R1(config)#interface fastEthernet 0/0 R1(config-if)#ip address 12.1.1.1 255.255.255.0 R1(config-if)#no shutdown  R1(config-if)#exit  R1(config)#interface loopback 0 R1(config-if)#ip address 11.1.1.1 255.255.255.0</code></pre><p>在R2上:</p><pre><code>R2(config)#interface fastEthernet 1/0 R2(config-if)#ip address 23.1.1.2 255.255.255.0 R2(config-if)#no shutdown  R2(config-if)#exit R2(config)#interface loopback 0 R2(config-if)#ip address 22.1.1.1 255.255.255.0</code></pre><p>在R3上:</p><pre><code>R3(config)#interface fastEthernet 0/0R3(config-if)#ip address 23.1.1.3 255.255.255.0R3(config-if)#no shutdown R3(config-if)#exitR3(config)#interface loopback 0R3(config-if)#ip address 33.1.1.1 255.255.255.0</code></pre>]]></content>
      
      
      
        <tags>
            
            <tag> RIP </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
